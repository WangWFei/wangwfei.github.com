<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
	<title>Document</title>
	<style>
	
	div{width: 100px; height: 100px; background: #ccc; margin: 50px; float: left;}
	#div1{width: 150px; height: 150px;background: red; position: absolute; bottom: 0;right: 0; margin: 0;}
	</style>
	<script>
	window.onload=function(){
		var oDiv=document.getElementById('div1');
		var aDiv=document.getElementsByTagName('div');
		//collTest(oDiv,aDiv[1]);

		

		oDiv.onmousedown=function(ev){
			oEvt=ev||event;
			var disX=oEvt.clientX-oDiv.offsetLeft;
			var disY=oEvt.clientY-oDiv.offsetTop;

			document.onmousemove=function(ev){
				oEvt=ev||event;
				oDiv.style.left=oEvt.clientX-disX+'px';
				oDiv.style.top=oEvt.clientY-disY+'px';

				//碰撞检测
				for(var i=0;i<aDiv.length;i++){
					if(oDiv==aDiv[i]) continue;
					else{
						if(collTest(oDiv,aDiv[i])){
							aDiv[i].style.background='green';
							//break;
						}else{
							aDiv[i].style.background='#ccc';
						}
					}
				}
			}
			document.onmouseup=function(ev){
				document.onmousemove=null;
				document.onmouseup=null;
				oDiv.releaseCapture&&oDiv.releaseCapture();
			}
			oDiv.setCapture&& oDiv.setCapture();
			return false;
		}

		//封装碰撞方法
		function collTest(obj1,obj2){
			var l1=obj1.offsetLeft;
			var t1=obj1.offsetTop;
			var r1=obj1.offsetLeft+obj1.offsetWidth;
			var b1=obj1.offsetTop+obj1.offsetHeight;

			var l2=obj2.offsetLeft;
			var t2=obj2.offsetTop;
			var r2=obj2.offsetLeft+obj2.offsetWidth;
			var b2=obj2.offsetTop+obj2.offsetHeight;

			if(l1>r2||t1>b2||r1<l2||b1<t2){
				return false;
			}else{
				return true;
			}
		}
	}
	</script>
</head>
<body>
	<div></div>
	<div></div>
	<div></div>
	<div id="div1"></div>
	<div></div>
	<div></div>
	<div></div>
	<div></div>
	<div></div>
	<div></div>
	<div></div>
</body>
</html>